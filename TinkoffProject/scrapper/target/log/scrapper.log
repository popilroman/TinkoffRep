2023-04-24 15:18:24,002 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 15:18:24,373 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-24 15:18:25,216 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-24 15:18:25,310 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-24 15:18:27,890 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-24 15:18:27,894 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-24 15:18:28,080 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-24 15:18:28,319 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-24 15:18:29,501 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-24 15:18:30,737 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 3643eab620b64e4972915997f6c67260dfdcef9ab4422e657592f8a01c2c8e89
2023-04-24 15:18:36,653 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT8.5461193S
2023-04-24 15:18:37,015 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-24 15:18:37,017 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-24 15:18:37,020 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-24 15:18:37,022 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-24 15:18:37,521 INFO docker[postgres:15] [main] Container postgres:15 is starting: 151af98bcae287b86392f21787f77f420c24bdc67a1d9e0081694f45c078dc6b
2023-04-24 15:18:47,709 INFO docker[postgres:15] [main] Container postgres:15 started in PT10.6875904S
2023-04-24 15:18:49,052 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-24 15:18:49,290 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 16100 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-24 15:18:49,296 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-24 15:19:03,947 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 15.827 seconds (process running for 43.156)
2023-04-24 15:19:04,235 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 15:19:07,209 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 15:19:07,248 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-24 15:19:10,178 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 15:19:10,184 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-24 16:12:43,538 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:12:44,045 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-24 16:12:45,130 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-24 16:12:45,196 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-24 16:12:47,383 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-24 16:12:47,386 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-24 16:12:47,550 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-24 16:12:47,707 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-24 16:12:48,799 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-24 16:12:49,811 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: c9efd69a9caeed75859b9695e52b3e87c841cad97cf9373d00aacc1ebc003478
2023-04-24 16:12:55,999 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT8.4175282S
2023-04-24 16:12:56,248 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-24 16:12:56,250 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-24 16:12:56,252 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-24 16:12:56,255 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-24 16:12:56,643 INFO docker[postgres:15] [main] Container postgres:15 is starting: 2be4d92c8bcd650f9c53fb314fad401c6a9ba5d8f8e404ae83173b64f2d8a78c
2023-04-24 16:13:06,276 INFO docker[postgres:15] [main] Container postgres:15 started in PT10.022087S
2023-04-24 16:13:07,515 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-24 16:13:07,578 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 15084 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-24 16:13:07,584 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-24 16:13:21,628 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 15.053 seconds (process running for 41.632)
2023-04-24 16:13:23,946 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:13:25,342 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:25,730 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:26,325 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-04-24 16:13:26,385 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:27,216 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:13:27,253 INFO l.changelog [main] ChangeSet link-info-schema.sql::23::admin ran successfully in 520ms
2023-04-24 16:13:27,769 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:13:27,773 INFO l.changelog [main] ChangeSet link-info-insert.sql::23::admin ran successfully in 92ms
2023-04-24 16:13:27,794 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:28,314 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:13:28,358 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-24 16:13:28,627 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:28,928 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:30,113 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:30,329 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:30,840 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:30,969 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:31,156 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:31,278 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:31,752 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:31,872 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:32,080 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:32,264 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:32,601 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:32,754 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:32,928 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:33,017 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:33,276 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:33,399 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:33,659 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:33,776 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:34,005 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:34,151 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:34,450 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:34,617 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:34,977 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:35,096 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:35,379 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:35,476 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:36,775 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:36,909 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:37,069 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:37,192 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:37,433 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:13:37,437 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-24 16:13:37,621 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:37,737 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:37,974 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:38,094 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:38,591 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:38,789 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:39,061 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:39,256 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:39,471 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.dao.EmptyResultDataAccessException: Incorrect result size: expected 1, actual 0
	at org.springframework.dao.support.DataAccessUtils.nullableSingleResult(DataAccessUtils.java:97)
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:887)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkUpdatesRepositoryImp.findUpdatesByLinkId(LinkUpdatesRepositoryImp.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkUpdatesRepositoryImp$$SpringCGLIB$$0.findUpdatesByLinkId(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findUpdatesByLinkIdAndLinkType(JdbcLinksService.java:67)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:699)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findUpdatesByLinkIdAndLinkType(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.lambda$getUpdatesForGitHubLinks$1(LinkUpdaterScheduler.java:65)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.getUpdatesForGitHubLinks(LinkUpdaterScheduler.java:56)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:47)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
2023-04-24 16:13:39,616 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:39,749 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:39,899 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:39,985 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:13:40,198 INFO l.database [main] Set default schema name to public
2023-04-24 16:13:40,282 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:13:40,497 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:13:40,642 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:27:36,498 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:27:36,921 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-24 16:27:37,575 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-24 16:27:37,673 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-24 16:27:39,769 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-24 16:27:39,774 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-24 16:27:40,037 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-24 16:27:40,209 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-24 16:27:41,168 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-24 16:27:42,045 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 4251b563d83eeed13848d583651af30114e97e7036c876809aea8fa52cbe4294
2023-04-24 16:27:47,168 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT7.1027031S
2023-04-24 16:27:47,331 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-24 16:27:47,332 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-24 16:27:47,335 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-24 16:27:47,337 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-24 16:27:48,180 INFO docker[postgres:15] [main] Container postgres:15 is starting: 2eb5ec0dc218d061118a75b6067d0442c44dd1f7e4fd886c894908d9c4f99ffa
2023-04-24 16:27:56,133 INFO docker[postgres:15] [main] Container postgres:15 started in PT8.7961194S
2023-04-24 16:27:56,875 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-24 16:27:56,930 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 10400 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-24 16:27:56,935 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-24 16:28:08,010 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 11.663 seconds (process running for 34.122)
2023-04-24 16:28:08,315 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:28:10,791 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:11,350 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:12,495 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-04-24 16:28:12,543 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:14,857 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:28:14,873 INFO l.changelog [main] ChangeSet link-info-schema.sql::1::admin ran successfully in 2021ms
2023-04-24 16:28:15,497 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:28:15,504 INFO l.changelog [main] ChangeSet link-info-insert.sql::1::admin ran successfully in 150ms
2023-04-24 16:28:15,533 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:18,137 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:28:18,183 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-24 16:28:18,884 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: Колонки type не найдено в этом ResultSet’’е.
	at org.postgresql.jdbc.PgResultSet.findColumn(PgResultSet.java:2939)
	at org.postgresql.jdbc.PgResultSet.getString(PgResultSet.java:2796)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.lambda$findOneOldestLinksByLastCheckForEachUser$3(LinkRepositoryImpl.java:112)
	at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:94)
	at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:61)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:453)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:28:19,707 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:20,417 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:21,076 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:21,327 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:21,784 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:21,910 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:22,143 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:22,330 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:22,739 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:22,843 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:23,133 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:23,302 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:23,560 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:23,688 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:23,906 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:24,042 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:24,357 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:24,474 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:24,689 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:24,856 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:25,228 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:25,325 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:25,477 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:25,591 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:25,969 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:26,109 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:26,438 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:26,568 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:26,958 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:27,119 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:27,288 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:27,407 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:27,523 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:28:27,529 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-24 16:28:29,201 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:29,260 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: Колонки type не найдено в этом ResultSet’’е.
	at org.postgresql.jdbc.PgResultSet.findColumn(PgResultSet.java:2939)
	at org.postgresql.jdbc.PgResultSet.getString(PgResultSet.java:2796)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.lambda$findOneOldestLinksByLastCheckForEachUser$3(LinkRepositoryImpl.java:112)
	at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:94)
	at org.springframework.jdbc.core.RowMapperResultSetExtractor.extractData(RowMapperResultSetExtractor.java:61)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:453)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:28:29,451 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:29,738 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:29,867 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:30,208 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:30,324 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:30,508 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:30,660 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:30,984 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:31,373 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:31,663 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:31,821 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:28:32,055 INFO l.database [main] Set default schema name to public
2023-04-24 16:28:32,171 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:28:32,639 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:28:32,741 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:31:21,664 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:31:22,045 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-24 16:31:23,052 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-24 16:31:23,174 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-24 16:31:25,806 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-24 16:31:25,812 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-24 16:31:26,006 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-24 16:31:26,231 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-24 16:31:27,840 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-24 16:31:29,634 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: cf586a5390fe80c20ed566a58e234304b723d04c816b0f434626ba28f598eaa9
2023-04-24 16:31:35,680 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT9.6478992S
2023-04-24 16:31:35,831 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-24 16:31:35,832 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-24 16:31:35,835 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-24 16:31:35,837 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-24 16:31:36,804 INFO docker[postgres:15] [main] Container postgres:15 is starting: db380345be5e8b1f1614057ac6c22037eef567bf3fe6743136217603493751e4
2023-04-24 16:31:45,886 INFO docker[postgres:15] [main] Container postgres:15 started in PT10.0486854S
2023-04-24 16:31:46,855 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-24 16:31:46,926 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 3512 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-24 16:31:46,930 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-24 16:32:04,891 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 18.799 seconds (process running for 46.379)
2023-04-24 16:32:08,233 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:32:11,365 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:18,991 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:19,339 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:32:28,292 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-04-24 16:32:28,321 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:28,831 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:32:28,835 INFO l.changelog [main] ChangeSet link-info-schema.sql::23::admin ran successfully in 194ms
2023-04-24 16:32:29,064 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:32:29,069 INFO l.changelog [main] ChangeSet link-info-insert.sql::23::admin ran successfully in 89ms
2023-04-24 16:32:29,210 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:29,804 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:32:29,813 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-24 16:32:30,180 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:30,486 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:31,171 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:31,532 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:31,822 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:31,974 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:32,243 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:32,443 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:32,699 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:32,924 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:33,144 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:33,321 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:33,565 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:33,654 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:33,862 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:33,994 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:34,396 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:34,526 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:34,728 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:34,904 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:35,064 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:35,177 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:35,446 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:35,662 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:35,901 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:36,042 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:36,218 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.web.reactive.function.client.WebClientRequestException: Connection refused: no further information: localhost/127.0.0.1:8080
	at org.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction.lambda$wrapException$9(ExchangeFunctions.java:136)
	Suppressed: reactor.core.publisher.FluxOnAssembly$OnAssemblyException: 
Error has been observed at the following site(s):
	*__checkpoint ? Request to POST http://localhost:8080/updates [DefaultWebClient]
Original Stack Trace:
		at org.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction.lambda$wrapException$9(ExchangeFunctions.java:136)
		at reactor.core.publisher.MonoErrorSupplied.subscribe(MonoErrorSupplied.java:55)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4444)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.MonoNext$NextSubscriber.onError(MonoNext.java:93)
		at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onError(MonoFlatMapMany.java:204)
		at reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenMainSubscriber.whenError(FluxRetryWhen.java:225)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenOtherSubscriber.onError(FluxRetryWhen.java:274)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onError(FluxContextWrite.java:121)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.maybeOnError(FluxConcatMapNoPrefetch.java:326)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.onNext(FluxConcatMapNoPrefetch.java:211)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onNext(FluxContextWrite.java:107)
		at reactor.core.publisher.SinkManyEmitterProcessor.drain(SinkManyEmitterProcessor.java:471)
		at reactor.core.publisher.SinkManyEmitterProcessor$EmitterInner.drainParent(SinkManyEmitterProcessor.java:615)
		at reactor.core.publisher.FluxPublish$PubSubInner.request(FluxPublish.java:602)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.request(FluxConcatMapNoPrefetch.java:336)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
		at reactor.core.publisher.Operators$DeferredSubscription.request(Operators.java:1717)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenMainSubscriber.onError(FluxRetryWhen.java:192)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.http.client.HttpClientConnect$MonoHttpConnect$ClientTransportSubscriber.onError(HttpClientConnect.java:307)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.resources.DefaultPooledConnectionProvider$DisposableAcquire.onError(DefaultPooledConnectionProvider.java:162)
		at reactor.netty.internal.shaded.reactor.pool.AbstractPool$Borrower.fail(AbstractPool.java:475)
		at reactor.netty.internal.shaded.reactor.pool.SimpleDequePool.lambda$drainLoop$9(SimpleDequePool.java:429)
		at reactor.core.publisher.FluxDoOnEach$DoOnEachSubscriber.onError(FluxDoOnEach.java:186)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.resources.DefaultPooledConnectionProvider$PooledConnectionAllocator$PooledConnectionInitializer.onError(DefaultPooledConnectionProvider.java:560)
		at reactor.core.publisher.MonoFlatMap$FlatMapMain.secondError(MonoFlatMap.java:241)
		at reactor.core.publisher.MonoFlatMap$FlatMapInner.onError(MonoFlatMap.java:315)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:106)
		at reactor.core.publisher.Operators.error(Operators.java:198)
		at reactor.core.publisher.MonoError.subscribe(MonoError.java:53)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4444)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)
		at reactor.netty.transport.TransportConnector$MonoChannelPromise.tryFailure(TransportConnector.java:587)
		at reactor.netty.transport.TransportConnector$MonoChannelPromise.setFailure(TransportConnector.java:541)
		at reactor.netty.transport.TransportConnector.lambda$doConnect$7(TransportConnector.java:265)
		at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
		at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:583)
		at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:559)
		at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
		at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
		at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:629)
		at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:118)
		at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.fulfillConnectPromise(AbstractNioChannel.java:321)
		at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:337)
		at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
		at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
		at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
		at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
		at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
		at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
		at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
		at java.base/java.lang.Thread.run(Thread.java:833)
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:99)
		at reactor.core.publisher.Mono.block(Mono.java:1710)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.sendRequestToBot(LinkUpdaterScheduler.java:121)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.lambda$getUpdatesForGitHubLinks$1(LinkUpdaterScheduler.java:68)
		at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
		at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
		at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
		at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
		at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
		at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
		at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
		at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
		at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.getUpdatesForGitHubLinks(LinkUpdaterScheduler.java:56)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:47)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
		at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.base/java.lang.reflect.Method.invoke(Method.java:568)
		at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
		at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
		at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
		at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
		at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
		at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
		at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
		at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: no further information: localhost/127.0.0.1:8080
Caused by: java.net.ConnectException: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:946)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:833)
2023-04-24 16:32:36,456 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:36,582 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:36,722 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:36,839 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:37,084 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:37,185 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:37,220 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:32:37,225 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-24 16:32:37,563 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:37,685 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:38,218 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:38,620 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:38,863 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:38,952 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:39,168 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:39,479 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:39,854 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:39,961 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:40,162 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:40,376 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:32:40,536 INFO l.database [main] Set default schema name to public
2023-04-24 16:32:40,614 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:32:40,755 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:32:40,842 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:35:21,003 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:35:21,328 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-24 16:35:22,348 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-24 16:35:22,433 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-24 16:35:24,965 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-24 16:35:24,969 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-24 16:35:25,134 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-24 16:35:25,357 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-24 16:35:26,417 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-24 16:35:28,033 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 8fc5e14bc1921e9dc4fe81835fccd000eb497b43d649af942d1ee8a83c6efd81
2023-04-24 16:35:34,039 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT8.8638563S
2023-04-24 16:35:34,227 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-24 16:35:34,229 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-24 16:35:34,232 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-24 16:35:34,237 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-24 16:35:34,662 INFO docker[postgres:15] [main] Container postgres:15 is starting: fe8757617ce443da3581553e5b928c441dc537223ed8c809d781c943e9e72822
2023-04-24 16:35:45,133 INFO docker[postgres:15] [main] Container postgres:15 started in PT10.8965725S
2023-04-24 16:35:46,648 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-24 16:35:46,734 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 13108 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-24 16:35:46,744 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-24 16:36:05,851 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 20.098 seconds (process running for 48.011)
2023-04-24 16:36:15,773 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-24 16:36:16,959 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:17,716 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:18,426 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-04-24 16:36:18,457 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:18,830 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:36:18,838 INFO l.changelog [main] ChangeSet link-info-schema.sql::23::admin ran successfully in 163ms
2023-04-24 16:36:19,024 INFO l.changelog [main] Custom SQL executed
2023-04-24 16:36:19,029 INFO l.changelog [main] ChangeSet link-info-insert.sql::23::admin ran successfully in 101ms
2023-04-24 16:36:19,063 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:19,669 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:36:19,700 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-24 16:36:21,013 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:21,200 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:21,731 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:21,923 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:22,419 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:22,568 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:22,862 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:22,998 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:23,391 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:23,476 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:23,642 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:23,777 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:24,111 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:24,195 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:24,398 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:24,516 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:25,028 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:25,323 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:25,526 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:25,674 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:26,027 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:26,210 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:26,540 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:26,658 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:27,393 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:27,625 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:27,932 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:28,279 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:28,939 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:29,080 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:29,505 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:29,847 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:30,265 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-24 16:36:30,275 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-24 16:36:30,495 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:30,630 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:30,914 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:31,194 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:32,446 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:32,674 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:33,289 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:33,609 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:34,143 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:34,199 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.dao.EmptyResultDataAccessException: Incorrect result size: expected 1, actual 0
	at org.springframework.dao.support.DataAccessUtils.nullableSingleResult(DataAccessUtils.java:97)
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:887)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkUpdatesRepositoryImp.findUpdatesByLinkId(LinkUpdatesRepositoryImp.java:27)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkUpdatesRepositoryImp$$SpringCGLIB$$0.findUpdatesByLinkId(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findUpdatesByLinkIdAndLinkType(JdbcLinksService.java:67)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:699)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findUpdatesByLinkIdAndLinkType(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.lambda$getUpdatesForGitHubLinks$1(LinkUpdaterScheduler.java:65)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.getUpdatesForGitHubLinks(LinkUpdaterScheduler.java:56)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:47)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
2023-04-24 16:36:34,274 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:34,527 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:34,609 INFO l.lockservice [main] Successfully released change log lock
2023-04-24 16:36:34,803 INFO l.database [main] Set default schema name to public
2023-04-24 16:36:34,936 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-24 16:36:35,194 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-24 16:36:35,362 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:09:56,859 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:09:57,191 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-25 21:09:57,968 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-25 21:09:58,181 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-25 21:09:58,245 INFO o.t.d.DockerMachineClientProviderStrategy [main] docker-machine executable was not found on PATH ([C:\Program Files\Common Files\Oracle\Java\javapath, C:\Program Files (x86)\Intel\iCLS Client\, C:\Program Files\Intel\iCLS Client\, C:\WINDOWS\system32, C:\WINDOWS, C:\WINDOWS\System32\Wbem, C:\WINDOWS\System32\WindowsPowerShell\v1.0\, C:\WINDOWS\System32\OpenSSH\, C:\Program Files\Intel\Intel(R) Management Engine Components\DAL, C:\Program Files\Intel\Intel(R) Management Engine Components\IPT, C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\DAL, C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\IPT, C:\Program Files\Java\jdk-17\bin, D:\Программы\Git\cmd, , C:\Program Files\Docker\Docker\resources\bin, C:\Users\HP\AppData\Local\Programs\Python\Python39\Scripts\, C:\Users\HP\AppData\Local\Programs\Python\Python39\, C:\Users\HP\AppData\Local\Microsoft\WindowsApps, D:\Программы\Microsoft VS Code\bin, D:\Программы\PyCharm Community Edition 2022.2.3\bin, , D:\Программы\IntelliJ IDEA Community Edition 2022.3.3\bin, C:\Program Files\apache-maven-3.8.6-bin\apache-maven-3.8.6\bin])
2023-04-25 21:09:58,245 ERROR o.t.d.DockerClientProviderStrategy [main] Could not find a valid Docker environment. Please check configuration. Attempted configurations were:
As no valid configuration was found, execution cannot continue.
See https://www.testcontainers.org/on_failure.html for more details.
2023-04-25 21:09:58,366 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:09:58,396 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-25 21:09:58,506 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:09:58,518 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-25 21:47:34,256 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.container.ContainerTest]: ContainerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:47:34,631 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.container.ContainerTest
2023-04-25 21:47:35,543 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-04-25 21:47:35,646 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-04-25 21:47:41,005 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-04-25 21:47:41,010 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-04-25 21:47:44,912 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 20.10.24
  API Version: 1.41
  Operating System: Docker Desktop
  Total Memory: 1791 MB
2023-04-25 21:47:45,214 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-04-25 21:47:46,904 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-04-25 21:47:49,978 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 95c379f457825fc27d7d6a96bcd7069bf5ac16f7112b83d6716f34f76edb4bca
2023-04-25 21:48:27,854 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT42.8933946S
2023-04-25 21:48:28,626 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-04-25 21:48:28,630 INFO o.t.DockerClientFactory [main] Checking the system...
2023-04-25 21:48:28,638 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-04-25 21:48:28,651 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-04-25 21:48:29,552 INFO docker[postgres:15] [main] Container postgres:15 is starting: c8646b2a4912c6b27b3b0357f9c2d238ee0ad63724a33b45971e25cbbabd5867
2023-04-25 21:48:39,236 INFO docker[postgres:15] [main] Container postgres:15 started in PT10.5889647S
2023-04-25 21:48:40,767 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-04-25 21:48:40,830 INFO r.t.e.j.s.c.ContainerTest [main] Starting ContainerTest using Java 17.0.6 with PID 15916 (started by Роман in D:\BackendDev Tinkoff\TinkoffRep\TinkoffProject\scrapper)
2023-04-25 21:48:40,835 INFO r.t.e.j.s.c.ContainerTest [main] No active profile set, falling back to 1 default profile: "default"
2023-04-25 21:48:58,432 INFO r.t.e.j.s.c.ContainerTest [main] Started ContainerTest in 18.746 seconds (process running for 88.662)
2023-04-25 21:48:58,818 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-25 21:49:01,689 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:02,445 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:03,019 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-04-25 21:49:03,050 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:19,846 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-04-25 21:49:21,302 INFO l.changelog [main] Custom SQL executed
2023-04-25 21:49:21,306 INFO l.changelog [main] ChangeSet link-info-schema.sql::23::admin ran successfully in 2402ms
2023-04-25 21:49:21,765 INFO l.changelog [main] Custom SQL executed
2023-04-25 21:49:21,771 INFO l.changelog [main] ChangeSet link-info-insert.sql::23::admin ran successfully in 223ms
2023-04-25 21:49:21,876 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:26,803 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:49:26,816 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-04-25 21:49:29,835 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:31,173 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:32,481 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:32,806 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:33,781 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:34,068 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:34,437 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:34,603 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:35,148 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:35,323 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:35,900 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:36,256 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:36,790 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:37,059 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:37,239 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.web.reactive.function.client.WebClientRequestException: Connection refused: no further information: localhost/127.0.0.1:8080
	at org.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction.lambda$wrapException$9(ExchangeFunctions.java:136)
	Suppressed: reactor.core.publisher.FluxOnAssembly$OnAssemblyException: 
Error has been observed at the following site(s):
	*__checkpoint ? Request to POST http://localhost:8080/updates [DefaultWebClient]
Original Stack Trace:
		at org.springframework.web.reactive.function.client.ExchangeFunctions$DefaultExchangeFunction.lambda$wrapException$9(ExchangeFunctions.java:136)
		at reactor.core.publisher.MonoErrorSupplied.subscribe(MonoErrorSupplied.java:55)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4444)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.FluxPeek$PeekSubscriber.onError(FluxPeek.java:222)
		at reactor.core.publisher.MonoNext$NextSubscriber.onError(MonoNext.java:93)
		at reactor.core.publisher.MonoFlatMapMany$FlatMapManyMain.onError(MonoFlatMapMany.java:204)
		at reactor.core.publisher.SerializedSubscriber.onError(SerializedSubscriber.java:124)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenMainSubscriber.whenError(FluxRetryWhen.java:225)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenOtherSubscriber.onError(FluxRetryWhen.java:274)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onError(FluxContextWrite.java:121)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.maybeOnError(FluxConcatMapNoPrefetch.java:326)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.onNext(FluxConcatMapNoPrefetch.java:211)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.onNext(FluxContextWrite.java:107)
		at reactor.core.publisher.SinkManyEmitterProcessor.drain(SinkManyEmitterProcessor.java:471)
		at reactor.core.publisher.SinkManyEmitterProcessor$EmitterInner.drainParent(SinkManyEmitterProcessor.java:615)
		at reactor.core.publisher.FluxPublish$PubSubInner.request(FluxPublish.java:602)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
		at reactor.core.publisher.FluxConcatMapNoPrefetch$FluxConcatMapNoPrefetchSubscriber.request(FluxConcatMapNoPrefetch.java:336)
		at reactor.core.publisher.FluxContextWrite$ContextWriteSubscriber.request(FluxContextWrite.java:136)
		at reactor.core.publisher.Operators$DeferredSubscription.request(Operators.java:1717)
		at reactor.core.publisher.FluxRetryWhen$RetryWhenMainSubscriber.onError(FluxRetryWhen.java:192)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.http.client.HttpClientConnect$MonoHttpConnect$ClientTransportSubscriber.onError(HttpClientConnect.java:307)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.resources.DefaultPooledConnectionProvider$DisposableAcquire.onError(DefaultPooledConnectionProvider.java:162)
		at reactor.netty.internal.shaded.reactor.pool.AbstractPool$Borrower.fail(AbstractPool.java:475)
		at reactor.netty.internal.shaded.reactor.pool.SimpleDequePool.lambda$drainLoop$9(SimpleDequePool.java:429)
		at reactor.core.publisher.FluxDoOnEach$DoOnEachSubscriber.onError(FluxDoOnEach.java:186)
		at reactor.core.publisher.MonoCreate$DefaultMonoSink.error(MonoCreate.java:201)
		at reactor.netty.resources.DefaultPooledConnectionProvider$PooledConnectionAllocator$PooledConnectionInitializer.onError(DefaultPooledConnectionProvider.java:560)
		at reactor.core.publisher.MonoFlatMap$FlatMapMain.secondError(MonoFlatMap.java:241)
		at reactor.core.publisher.MonoFlatMap$FlatMapInner.onError(MonoFlatMap.java:315)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:106)
		at reactor.core.publisher.Operators.error(Operators.java:198)
		at reactor.core.publisher.MonoError.subscribe(MonoError.java:53)
		at reactor.core.publisher.Mono.subscribe(Mono.java:4444)
		at reactor.core.publisher.FluxOnErrorResume$ResumeSubscriber.onError(FluxOnErrorResume.java:103)
		at reactor.netty.transport.TransportConnector$MonoChannelPromise.tryFailure(TransportConnector.java:587)
		at reactor.netty.transport.TransportConnector$MonoChannelPromise.setFailure(TransportConnector.java:541)
		at reactor.netty.transport.TransportConnector.lambda$doConnect$7(TransportConnector.java:265)
		at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:590)
		at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:583)
		at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:559)
		at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:492)
		at io.netty.util.concurrent.DefaultPromise.setValue0(DefaultPromise.java:636)
		at io.netty.util.concurrent.DefaultPromise.setFailure0(DefaultPromise.java:629)
		at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:118)
		at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.fulfillConnectPromise(AbstractNioChannel.java:321)
		at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:337)
		at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
		at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
		at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
		at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
		at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
		at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
		at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
		at java.base/java.lang.Thread.run(Thread.java:833)
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:99)
		at reactor.core.publisher.Mono.block(Mono.java:1710)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.sendRequestToBot(LinkUpdaterScheduler.java:121)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.lambda$getUpdatesForGitHubLinks$1(LinkUpdaterScheduler.java:68)
		at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
		at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
		at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
		at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
		at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
		at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
		at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
		at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
		at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.getUpdatesForGitHubLinks(LinkUpdaterScheduler.java:56)
		at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:47)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
		at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
		at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.base/java.lang.reflect.Method.invoke(Method.java:568)
		at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
		at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
		at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
		at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
		at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
		at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
		at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
		at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: no further information: localhost/127.0.0.1:8080
Caused by: java.net.ConnectException: Connection refused: no further information
	at java.base/sun.nio.ch.Net.pollConnect(Native Method)
	at java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:946)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:833)
2023-04-25 21:49:37,451 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:37,565 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:38,568 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:38,854 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:39,153 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:39,308 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:39,642 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:39,765 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:39,963 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:40,062 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:40,319 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:40,411 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:40,604 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:40,745 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:41,081 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:41,241 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:41,446 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:41,559 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:41,727 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-04-25 21:49:41,730 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-04-25 21:49:41,919 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:42,104 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:42,326 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:42,474 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:43,023 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:43,182 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:43,411 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:43,554 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:43,877 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:43,992 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:44,253 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:44,365 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:44,565 INFO l.database [main] Set default schema name to public
2023-04-25 21:49:44,679 INFO l.lockservice [main] Successfully acquired change log lock
2023-04-25 21:49:44,866 INFO l.changelog [main] Reading from public.databasechangelog
2023-04-25 21:49:45,010 INFO l.lockservice [main] Successfully released change log lock
2023-04-25 21:49:47,455 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
reactor.core.Exceptions$ReactiveException: java.lang.InterruptedException
	at reactor.core.Exceptions.propagate(Exceptions.java:408)
	at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:91)
	at reactor.core.publisher.Mono.block(Mono.java:1710)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.lambda$getUpdatesForGitHubLinks$1(LinkUpdaterScheduler.java:61)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1625)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.getUpdatesForGitHubLinks(LinkUpdaterScheduler.java:56)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:47)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: java.lang.InterruptedException: null
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1048)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:230)
	at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:87)
	... 25 common frames omitted
2023-05-21 23:30:16,227 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-21 23:30:16,311 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-05-21 23:30:16,435 WARN o.t.u.TestcontainersConfiguration [main] Attempted to read Testcontainers configuration file at file:/C:/Users/PC-/.testcontainers.properties but the file was not found. Exception message: FileNotFoundException: C:\Users\PC-\.testcontainers.properties (Не удается найти указанный файл)
2023-05-21 23:30:16,438 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-05-21 23:30:16,726 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-05-21 23:30:16,729 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-05-21 23:30:16,744 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 23.0.5
  API Version: 1.42
  Operating System: Docker Desktop
  Total Memory: 7798 MB
2023-05-21 23:30:16,765 INFO d.3.4] [main] Pulling docker image: testcontainers/ryuk:0.3.4. Please be patient; this may take some time but only needs to be done once.
2023-05-21 23:30:16,901 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-05-21 23:30:21,369 INFO d.3.4] [docker-java-stream-257369379] Starting to pull image
2023-05-21 23:30:21,391 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  0 pending,  0 downloaded,  0 extracted, (0 bytes/0 bytes)
2023-05-21 23:30:22,843 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  2 pending,  1 downloaded,  0 extracted, (767 KB/? MB)
2023-05-21 23:30:23,168 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  1 pending,  2 downloaded,  0 extracted, (3 MB/? MB)
2023-05-21 23:30:23,269 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  1 pending,  2 downloaded,  1 extracted, (4 MB/? MB)
2023-05-21 23:30:23,328 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  1 pending,  2 downloaded,  2 extracted, (4 MB/? MB)
2023-05-21 23:30:23,433 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  0 pending,  3 downloaded,  2 extracted, (5 MB/5 MB)
2023-05-21 23:30:23,503 INFO d.3.4] [docker-java-stream-257369379] Pulling image layers:  0 pending,  3 downloaded,  3 extracted, (5 MB/5 MB)
2023-05-21 23:30:23,516 INFO d.3.4] [docker-java-stream-257369379] Pull complete. 3 layers, pulled in 2s (downloaded 5 MB at 2 MB/s)
2023-05-21 23:30:23,540 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-05-21 23:30:23,614 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: d9831c659f869a61be52fec6b1ba287e3803e623a33fcca4e0bb384fc92c52c8
2023-05-21 23:30:24,019 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT7.2697685S
2023-05-21 23:30:24,024 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-05-21 23:30:24,024 INFO o.t.DockerClientFactory [main] Checking the system...
2023-05-21 23:30:24,025 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-05-21 23:30:24,025 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-05-21 23:30:24,047 INFO docker[postgres:15] [main] Container postgres:15 is starting: cc51b57b2ec89b6af05f5727314c5fadf6c099f27e515a850347b6f0714f86d9
2023-05-21 23:30:25,200 INFO docker[postgres:15] [main] Container postgres:15 started in PT1.1743717S
2023-05-21 23:30:25,380 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-05-21 23:30:25,395 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] Starting JdbcLinksServiceTest using Java 17.0.7 with PID 14056 (started by PC- in C:\Java Development\TinkoffRep\TinkoffProject\scrapper)
2023-05-21 23:30:25,396 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] No active profile set, falling back to 1 default profile: "default"
2023-05-21 23:30:28,846 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] Started JdbcLinksServiceTest in 3.618 seconds (process running for 13.277)
2023-05-21 23:30:28,966 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl.findOneOldestLinksByLastCheckForEachUser(LinkRepositoryImpl.java:107)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.imp.LinkRepositoryImpl$$SpringCGLIB$$0.findOneOldestLinksByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:61)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-05-21 23:30:29,522 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:29,585 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:29,685 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-05-21 23:30:29,690 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:29,751 INFO l.changelog [main] Custom SQL executed
2023-05-21 23:30:29,752 INFO l.changelog [main] ChangeSet link-info-schema.sql::23::admin ran successfully in 18ms
2023-05-21 23:30:29,784 INFO l.changelog [main] Custom SQL executed
2023-05-21 23:30:29,785 INFO l.changelog [main] ChangeSet link-info-insert.sql::23::admin ran successfully in 14ms
2023-05-21 23:30:29,788 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:29,879 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:29,902 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:29,960 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:29,980 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,019 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,038 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,081 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,112 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,157 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,178 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,217 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,244 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,282 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,300 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,342 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,370 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,410 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,427 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,461 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,479 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,524 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,539 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,569 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,584 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,620 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,635 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,673 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,690 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,710 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-21 23:30:30,711 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-05-21 23:30:30,740 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,756 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,788 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,805 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,857 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,872 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:30,906 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:30,924 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:30,958 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:30,975 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:31,005 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:31,021 INFO l.lockservice [main] Successfully released change log lock
2023-05-21 23:30:31,056 INFO l.database [main] Set default schema name to public
2023-05-21 23:30:31,073 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-21 23:30:31,105 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-21 23:30:31,125 INFO l.lockservice [main] Successfully released change log lock
