2023-05-31 14:20:07,500 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest]: JdbcLinksServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-31 14:20:07,722 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksServiceTest
2023-05-31 14:20:07,973 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-05-31 14:20:08,051 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-05-31 14:20:08,702 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-05-31 14:20:08,704 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-05-31 14:20:08,727 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 23.0.5
  API Version: 1.42
  Operating System: Docker Desktop
  Total Memory: 7798 MB
2023-05-31 14:20:08,764 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-05-31 14:20:08,979 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-05-31 14:20:09,183 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 8dd483018bee0911aa6ca0a24280e6ce1a3591713ffd42c2d3a77c7165bfb02b
2023-05-31 14:20:09,848 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT1.1117604S
2023-05-31 14:20:09,857 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-05-31 14:20:09,858 INFO o.t.DockerClientFactory [main] Checking the system...
2023-05-31 14:20:09,859 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-05-31 14:20:09,859 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-05-31 14:20:09,966 INFO docker[postgres:15] [main] Container postgres:15 is starting: 9124f860cb548d6e7f081bfa009c08176147a8b6bcd4aba9391a89df842772d3
2023-05-31 14:20:11,715 INFO docker[postgres:15] [main] Container postgres:15 started in PT1.8558582S
2023-05-31 14:20:12,174 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-05-31 14:20:12,220 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] Starting JdbcLinksServiceTest using Java 17.0.7 with PID 8672 (started by Роман in C:\Учеба\Java Development\TinkoffRep\TinkoffProject\scrapper)
2023-05-31 14:20:12,222 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] No active profile set, falling back to 1 default profile: "default"
2023-05-31 14:20:14,493 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-05-31 14:20:14,828 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 323 ms. Found 4 JPA repository interfaces.
2023-05-31 14:20:16,681 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2023-05-31 14:20:16,764 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.1.6.Final
2023-05-31 14:20:17,143 INFO SQL dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-05-31 14:20:17,901 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-05-31 14:20:17,913 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:20:28,109 INFO r.t.e.j.s.s.j.JdbcLinksServiceTest [main] Started JdbcLinksServiceTest in 16.365 seconds (process running for 21.755)
2023-05-31 14:20:28,281 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.jdbc.JdbcLinkRepository.findOneOldestLinkByLastCheckForEachUser(JdbcLinkRepository.java:108)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.jdbc.JdbcLinkRepository$$SpringCGLIB$$0.findOneOldestLinkByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:59)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-05-31 14:20:29,605 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:29,727 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:29,947 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-05-31 14:20:29,954 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:30,108 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:20:30,112 INFO l.changelog [main] ChangeSet link-info-schema.sql::31::admin ran successfully in 76ms
2023-05-31 14:20:30,204 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:20:30,206 INFO l.changelog [main] ChangeSet link-info-insert.sql::31::admin ran successfully in 39ms
2023-05-31 14:20:30,219 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:30,382 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:30,442 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:30,608 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:30,677 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:30,756 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:30,797 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:30,886 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:30,944 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:31,013 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:31,058 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:31,153 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:31,222 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:31,300 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:31,353 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:31,436 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:31,497 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:31,579 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:31,635 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:31,707 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:31,802 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:31,887 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:31,929 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:32,004 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:32,046 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:32,101 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:32,135 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:32,206 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:32,242 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:32,348 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:20:34,201 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest]: JdbcTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-31 14:20:34,411 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcTgChatServiceTest
2023-05-31 14:20:34,662 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-05-31 14:20:34,683 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-05-31 14:20:35,208 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-05-31 14:20:35,210 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-05-31 14:20:35,231 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 23.0.5
  API Version: 1.42
  Operating System: Docker Desktop
  Total Memory: 7798 MB
2023-05-31 14:20:35,269 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-05-31 14:20:35,483 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-05-31 14:20:35,712 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: d14bde95ddb791746d38a846cfba9f445ac4811627e7aa55e50162ad74ced786
2023-05-31 14:20:36,321 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT1.0788152S
2023-05-31 14:20:36,330 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-05-31 14:20:36,331 INFO o.t.DockerClientFactory [main] Checking the system...
2023-05-31 14:20:36,332 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-05-31 14:20:36,332 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-05-31 14:20:36,449 INFO docker[postgres:15] [main] Container postgres:15 is starting: b32ecdcad608bb97068c9a11d6944927f18e57bca157c07bb43f8dbbe582b1f7
2023-05-31 14:20:38,156 INFO docker[postgres:15] [main] Container postgres:15 started in PT1.8246271S
2023-05-31 14:20:38,606 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-05-31 14:20:38,640 INFO r.t.e.j.s.s.j.JdbcTgChatServiceTest [main] Starting JdbcTgChatServiceTest using Java 17.0.7 with PID 12660 (started by Роман in C:\Учеба\Java Development\TinkoffRep\TinkoffProject\scrapper)
2023-05-31 14:20:38,643 INFO r.t.e.j.s.s.j.JdbcTgChatServiceTest [main] No active profile set, falling back to 1 default profile: "default"
2023-05-31 14:20:41,020 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-05-31 14:20:41,377 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 343 ms. Found 4 JPA repository interfaces.
2023-05-31 14:20:43,490 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2023-05-31 14:20:43,606 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.1.6.Final
2023-05-31 14:20:44,174 INFO SQL dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-05-31 14:20:45,179 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-05-31 14:20:45,190 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:20:55,359 INFO r.t.e.j.s.s.j.JdbcTgChatServiceTest [main] Started JdbcTgChatServiceTest in 17.166 seconds (process running for 22.27)
2023-05-31 14:20:55,513 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.jdbc.BadSqlGrammarException: StatementCallback; bad SQL grammar [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:99)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.core.JdbcTemplate.translateException(JdbcTemplate.java:1538)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:393)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:465)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:475)
	at ru.tinkoff.edu.java.scrapper.repository.jdbc.JdbcLinkRepository.findOneOldestLinkByLastCheckForEachUser(JdbcLinkRepository.java:108)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.repository.jdbc.JdbcLinkRepository$$SpringCGLIB$$0.findOneOldestLinkByLastCheckForEachUser(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService.findAllOldestLinksByLastCheck(JdbcLinksService.java:59)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at ru.tinkoff.edu.java.scrapper.service.jdbc.JdbcLinksService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:333)
	at org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:319)
	at org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:295)
	at org.postgresql.jdbc.PgStatement.executeQuery(PgStatement.java:244)
	at org.springframework.jdbc.core.JdbcTemplate$1QueryStatementCallback.doInStatement(JdbcTemplate.java:452)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:381)
	... 45 common frames omitted
2023-05-31 14:20:56,549 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:56,653 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:56,882 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-05-31 14:20:56,891 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:57,005 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:20:57,008 INFO l.changelog [main] ChangeSet link-info-schema.sql::31::admin ran successfully in 32ms
2023-05-31 14:20:57,086 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:20:57,087 INFO l.changelog [main] ChangeSet link-info-insert.sql::31::admin ran successfully in 35ms
2023-05-31 14:20:57,095 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:57,254 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:57,317 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:57,465 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:57,528 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:57,640 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:57,705 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:57,801 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:57,881 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:57,983 INFO l.database [main] Set default schema name to public
2023-05-31 14:20:58,032 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:20:58,124 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:20:58,183 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:20:58,273 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:21:00,630 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkServiceTest]: JpaLinkServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-31 14:21:00,892 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkServiceTest
2023-05-31 14:21:01,337 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-05-31 14:21:01,363 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-05-31 14:21:01,823 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-05-31 14:21:01,825 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-05-31 14:21:01,847 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 23.0.5
  API Version: 1.42
  Operating System: Docker Desktop
  Total Memory: 7798 MB
2023-05-31 14:21:01,890 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-05-31 14:21:02,096 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-05-31 14:21:02,290 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: c173d157a5f50863c2055279e2eb78841dbb3ae50d6723d5c4117ac28c8ff839
2023-05-31 14:21:02,925 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT1.0659303S
2023-05-31 14:21:02,936 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-05-31 14:21:02,937 INFO o.t.DockerClientFactory [main] Checking the system...
2023-05-31 14:21:02,938 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-05-31 14:21:02,939 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-05-31 14:21:03,018 INFO docker[postgres:15] [main] Container postgres:15 is starting: 6988cb49666ec04dc60b443f40d5065dbf90d5947aa5a6eb478e5f53cc388532
2023-05-31 14:21:04,763 INFO docker[postgres:15] [main] Container postgres:15 started in PT1.824112S
2023-05-31 14:21:05,150 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-05-31 14:21:05,180 INFO r.t.e.j.s.s.j.JpaLinkServiceTest [main] Starting JpaLinkServiceTest using Java 17.0.7 with PID 5212 (started by Роман in C:\Учеба\Java Development\TinkoffRep\TinkoffProject\scrapper)
2023-05-31 14:21:05,185 INFO r.t.e.j.s.s.j.JpaLinkServiceTest [main] No active profile set, falling back to 1 default profile: "default"
2023-05-31 14:21:08,067 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-05-31 14:21:08,480 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 392 ms. Found 4 JPA repository interfaces.
2023-05-31 14:21:10,430 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2023-05-31 14:21:10,605 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.1.6.Final
2023-05-31 14:21:11,137 INFO SQL dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-05-31 14:21:12,041 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-05-31 14:21:12,049 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:21:22,132 INFO r.t.e.j.s.s.j.JpaLinkServiceTest [main] Started JpaLinkServiceTest in 17.329 seconds (process running for 23.107)
2023-05-31 14:21:23,023 WARN o.h.e.j.s.SqlExceptionHelper [scheduling-1] SQL Error: 0, SQLState: 42P01
2023-05-31 14:21:23,025 ERROR o.h.e.j.s.SqlExceptionHelper [scheduling-1] ERROR: relation "link_info.link" does not exist
  Позиция: 18
2023-05-31 14:21:23,080 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:550)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:134)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:218)
	at jdk.proxy2/jdk.proxy2.$Proxy147.findOneOldestLinkByLastCheckForEachUser(Unknown Source)
	at ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkService.findAllOldestLinksByLastCheck(JpaLinkService.java:99)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:699)
	at ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:109)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:95)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:253)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:146)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getMetaData(AbstractResultSetAccess.java:33)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getColumnCount(AbstractResultSetAccess.java:49)
	at org.hibernate.query.results.ResultSetMappingImpl.resolve(ResultSetMappingImpl.java:187)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:559)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:350)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:166)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.list(JdbcSelectExecutorStandardImpl.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:31)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:105)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:602)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:363)
	at org.hibernate.query.Query.getResultList(Query.java:94)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:401)
	at jdk.proxy2/jdk.proxy2.$Proxy185.getResultList(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:127)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:148)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:136)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:136)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:120)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:164)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:77)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 28 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:217)
	... 63 common frames omitted
2023-05-31 14:21:23,531 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:23,656 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:23,877 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-05-31 14:21:23,883 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:23,988 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:21:23,989 INFO l.changelog [main] ChangeSet link-info-schema.sql::31::admin ran successfully in 29ms
2023-05-31 14:21:24,047 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:21:24,049 INFO l.changelog [main] ChangeSet link-info-insert.sql::31::admin ran successfully in 32ms
2023-05-31 14:21:24,063 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:24,302 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:24,341 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:24,512 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:24,568 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:24,673 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:24,724 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:24,794 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:24,853 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:24,949 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:25,008 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:25,091 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:25,159 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:25,260 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:25,329 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:25,428 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:25,508 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:25,621 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:25,705 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:25,793 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:25,865 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:25,985 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:26,014 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:26,078 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:26,126 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:26,195 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:26,235 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:26,306 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:26,346 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:26,428 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:21:28,327 INFO o.s.t.c.s.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [ru.tinkoff.edu.java.scrapper.service.jpa.JpaTgChatServiceTest]: JpaTgChatServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-05-31 14:21:28,585 INFO o.s.b.t.c.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration ru.tinkoff.edu.java.scrapper.ScrapperApplication for test class ru.tinkoff.edu.java.scrapper.service.jpa.JpaTgChatServiceTest
2023-05-31 14:21:28,843 INFO o.t.u.ImageNameSubstitutor [main] Image name substitution will be performed by: DefaultImageNameSubstitutor (composite of 'ConfigurationFileImageNameSubstitutor' and 'PrefixingImageNameSubstitutor')
2023-05-31 14:21:28,867 INFO o.t.d.DockerClientProviderStrategy [main] Loaded org.testcontainers.dockerclient.NpipeSocketClientProviderStrategy from ~/.testcontainers.properties, will try it first
2023-05-31 14:21:29,372 INFO o.t.d.DockerClientProviderStrategy [main] Found Docker environment with local Npipe socket (npipe:////./pipe/docker_engine)
2023-05-31 14:21:29,374 INFO o.t.DockerClientFactory [main] Docker host IP address is localhost
2023-05-31 14:21:29,396 INFO o.t.DockerClientFactory [main] Connected to docker: 
  Server Version: 23.0.5
  API Version: 1.42
  Operating System: Docker Desktop
  Total Memory: 7798 MB
2023-05-31 14:21:29,443 INFO d.3.4] [main] Creating container for image: testcontainers/ryuk:0.3.4
2023-05-31 14:21:29,632 INFO o.t.u.RegistryAuthLocator [main] Credential helper/store (docker-credential-desktop) does not have credentials for https://index.docker.io/v1/
2023-05-31 14:21:29,818 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 is starting: 2c012bb26a47370fe515548e927d6cdde9ab4686dff1558efd6d43bfd989a036
2023-05-31 14:21:30,455 INFO d.3.4] [main] Container testcontainers/ryuk:0.3.4 started in PT1.0364222S
2023-05-31 14:21:30,463 INFO o.t.u.RyukResourceReaper [main] Ryuk started - will monitor and terminate Testcontainers containers on JVM exit
2023-05-31 14:21:30,464 INFO o.t.DockerClientFactory [main] Checking the system...
2023-05-31 14:21:30,465 INFO o.t.DockerClientFactory [main] ?? Docker server version should be at least 1.6.0
2023-05-31 14:21:30,465 INFO docker[postgres:15] [main] Creating container for image: postgres:15
2023-05-31 14:21:30,583 INFO docker[postgres:15] [main] Container postgres:15 is starting: e2fa2783b3529baf42d4813eb98b3c0f7ea3646d387d9da6fb409e10f3deee76
2023-05-31 14:21:32,171 INFO docker[postgres:15] [main] Container postgres:15 started in PT1.7057454S
2023-05-31 14:21:32,593 INFO o.h.v.i.u.Version [background-preinit] HV000001: Hibernate Validator 8.0.0.Final
2023-05-31 14:21:32,687 INFO r.t.e.j.s.s.j.JpaTgChatServiceTest [main] Starting JpaTgChatServiceTest using Java 17.0.7 with PID 876 (started by Роман in C:\Учеба\Java Development\TinkoffRep\TinkoffProject\scrapper)
2023-05-31 14:21:32,688 INFO r.t.e.j.s.s.j.JpaTgChatServiceTest [main] No active profile set, falling back to 1 default profile: "default"
2023-05-31 14:21:35,324 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2023-05-31 14:21:35,665 INFO o.s.d.r.c.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 329 ms. Found 4 JPA repository interfaces.
2023-05-31 14:21:37,965 INFO o.h.j.i.u.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2023-05-31 14:21:38,109 INFO o.h.Version [main] HHH000412: Hibernate ORM core version 6.1.6.Final
2023-05-31 14:21:38,673 INFO SQL dialect [main] HHH000400: Using dialect: org.hibernate.dialect.PostgreSQLDialect
2023-05-31 14:21:39,630 INFO o.h.e.t.j.p.i.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2023-05-31 14:21:39,639 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2023-05-31 14:21:49,822 INFO r.t.e.j.s.s.j.JpaTgChatServiceTest [main] Started JpaTgChatServiceTest in 17.623 seconds (process running for 22.705)
2023-05-31 14:21:50,999 WARN o.h.e.j.s.SqlExceptionHelper [scheduling-1] SQL Error: 0, SQLState: 42P01
2023-05-31 14:21:51,001 ERROR o.h.e.j.s.SqlExceptionHelper [scheduling-1] ERROR: relation "link_info.link" does not exist
  Позиция: 18
2023-05-31 14:21:51,038 ERROR o.s.s.s.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:257)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:233)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:550)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:242)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:152)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:134)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:218)
	at jdk.proxy2/jdk.proxy2.$Proxy147.findOneOldestLinkByLastCheckForEachUser(Unknown Source)
	at ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkService.findAllOldestLinksByLastCheck(JpaLinkService.java:99)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:699)
	at ru.tinkoff.edu.java.scrapper.service.jpa.JpaLinkService$$SpringCGLIB$$0.findAllOldestLinksByLastCheck(<generated>)
	at ru.tinkoff.edu.java.scrapper.service.schedule.LinkUpdaterScheduler.update(LinkUpdaterScheduler.java:38)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [SELECT l1.* FROM link_info.link l1 WHERE l1.id = (SELECT l2.id FROM link_info.link l2 WHERE l2.chat_id = l1.chat_id ORDER BY l2.last_check LIMIT 1);]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:109)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:95)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:253)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:146)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getMetaData(AbstractResultSetAccess.java:33)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getColumnCount(AbstractResultSetAccess.java:49)
	at org.hibernate.query.results.ResultSetMappingImpl.resolve(ResultSetMappingImpl.java:187)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:559)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:350)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:166)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.list(JdbcSelectExecutorStandardImpl.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:31)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:105)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:602)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:363)
	at org.hibernate.query.Query.getResultList(Query.java:94)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:401)
	at jdk.proxy2/jdk.proxy2.$Proxy186.getResultList(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:127)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:90)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:148)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:136)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:136)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:120)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:164)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:77)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	... 28 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: relation "link_info.link" does not exist
  Позиция: 18
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:496)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:413)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:134)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:217)
	... 63 common frames omitted
2023-05-31 14:21:51,413 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:51,542 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:51,838 INFO l.changelog [main] Creating database history table with name: public.databasechangelog
2023-05-31 14:21:51,847 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:51,971 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:21:51,972 INFO l.changelog [main] ChangeSet link-info-schema.sql::31::admin ran successfully in 30ms
2023-05-31 14:21:52,030 INFO l.changelog [main] Custom SQL executed
2023-05-31 14:21:52,032 INFO l.changelog [main] ChangeSet link-info-insert.sql::31::admin ran successfully in 34ms
2023-05-31 14:21:52,043 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:52,194 INFO l.database [main] Set default schema name to public
2023-05-31 14:21:52,234 INFO l.lockservice [main] Successfully acquired change log lock
2023-05-31 14:21:52,390 INFO l.changelog [main] Reading from public.databasechangelog
2023-05-31 14:21:52,454 INFO l.lockservice [main] Successfully released change log lock
2023-05-31 14:21:52,587 INFO o.s.o.j.LocalContainerEntityManagerFactoryBean [SpringApplicationShutdownHook] Closing JPA EntityManagerFactory for persistence unit 'default'
